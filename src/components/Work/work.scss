// Variables
$timeline-width: 0.6rem;
$timeline-border: 0.2rem;
$card-min-width: 40rem;
$card-min-width-mobile: 30rem;
$mobile-breakpoint: 37.5em;

// Mixins
@mixin timeline-text {
  font-size: 0.85rem;
  font-weight: 300;
  color: var(--text-color);
  background-color: rgba(var(--background-color-rgb), 0.85);
  padding: 0.4rem 0.6rem;
  border-radius: 3px;
  backdrop-filter: blur(4px);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  white-space: nowrap;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

@mixin hover-highlight {
  &:hover {
    background-color: rgba(var(--color-secondary-light-rgb), 0.15);
    transform: translateY(-1px);
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
  }
}

@mixin timeline-marker {
  content: '';
  position: absolute;
  background-color: var(--color-secondary-light);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

// Animations
@keyframes fadeInDuration {
  from {
    opacity: 0;
    transform: rotate(180deg) translateX(2rem);
    letter-spacing: 0;
  }
  to {
    opacity: 1;
    transform: rotate(180deg) translateX(0);
    letter-spacing: 0.08rem;
  }
}

@keyframes scaleInLine {
  from { transform: scaleX(0); }
  to { transform: scaleX(1); }
}

@keyframes cardHover {
  0% {
    transform: translateY(0) scale(1);
  }
  50% {
    transform: translateY(-0.6rem) scale(1.012);
  }
  100% {
    transform: translateY(-0.5rem) scale(1.01);
  }
}

// Main Styles
.work {
  color: inherit;
  display: flex;
  flex-wrap: wrap;
  position: relative;
  margin-bottom: 3rem;

  // Work Items Container
  &__items {
    display: flex;
    flex-wrap: wrap;
    margin-left: 2rem;
  }

  // Individual Work Item
  &__item {
    backdrop-filter: blur(10px);
    padding: 2rem 3rem;
    margin: 0.2rem;
    background-color: rgba(white, 0.2);
    flex: 1;
    min-width: $card-min-width;
    position: relative;
    flex-grow: 1;
    transition: all 0.4s cubic-bezier(0.215, 0.61, 0.355, 1);
    height: auto;
    overflow: hidden;

    &::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 0%;
      height: $timeline-width;
      background-color: var(--color-secondary-light);
      transition: width 0.5s cubic-bezier(0.215, 0.61, 0.355, 1);
    }

    &:hover {
      background-color: rgba(white, 0.1);
      animation: cardHover 0.8s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;
      box-shadow: 0 1rem 2rem rgba(0, 0, 0, 0.2);
      cursor: pointer;

      &::before {
        width: 25%;
      }
    }

    // Work Item Text
    p {
      max-height: 0;
      opacity: 0;
      transition: all 0.5s ease-in-out;
      overflow: hidden;

      &.show-text,
      .work__item:hover & {
        max-height: 100vh;
        opacity: 1;
      }
    }

    &__date {
      font-style: italic;
      line-height: 3em;
    }

    &__place {
      top: 0;
      right: 0;
      float: right;
      margin: 1rem;
      shape-outside: margin-box;
    }
  }

  // Timeline Component
  &__timeline {
    width: $timeline-width;
    height: 100%;
    background-color: rgba(white, 0.1);
    position: absolute;

    // Timeline Gradient Overlay
    &::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(
        to bottom,
        rgba(white, 0.15) 0%,
        transparent 8%,
        transparent 92%,
        rgba(white, 0.15) 100%
      );
      pointer-events: none;
    }

    // Timeline Labels (Now/Start)
    &__now,
    &__start {
      position: absolute;
      right: $timeline-width * 2.5;
      font-size: 1.2rem;
      font-weight: 400;
      color: var(--text-color);
      transition: color 0.3s ease;
    }

    &__now { top: -2rem; }
    &__start { bottom: -2rem; }

    // Duration Display
    &__duration {
      position: absolute;
      right: $timeline-width * 6;
      transform-origin: right center;
      writing-mode: vertical-rl;
      transform: rotate(180deg);
      font-size: 0.85rem;
      font-weight: 300;
      color: var(--text-color);
      letter-spacing: 0.08rem;
      line-height: 1.4;
      text-transform: uppercase;
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.215, 0.61, 0.355, 1);
      animation: fadeInDuration 0.5s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;

      &:hover {
        letter-spacing: 0.12rem;
        color: var(--color-secondary-light);
      }
    }

    // Timeline Bars
    &__bar {
      position: absolute;
      width: $timeline-width;
      float: top;
      background-color: var(--color-secondary-light);
      transition: all 0.4s cubic-bezier(0.215, 0.61, 0.355, 1);
      border: {
        top: $timeline-border solid var(--background-color);
        bottom: $timeline-border solid var(--background-color);
      }

      &:hover {
        background-color: var(--color-secondary);
        box-shadow: 0 0 10px var(--color-secondary-light);
      }
    }

    &__subbar {
      @extend .work__timeline__bar;
      background-color: rgba(white, 0.5);

      &:hover {
        background-color: rgba(white, 0.7);
      }
    }
  }
}

// Mobile Styles
@media only screen and (max-width: $mobile-breakpoint) {
  .work {
    &__items {
      margin-left: 1rem;
    }

    &__item {
      min-width: $card-min-width-mobile;
    }

    &__timeline {
      &__now,
      &__start {
        position: absolute;
        left: 0;
      }

      &__now {
        top: -3rem;
      }

      &__start {
        bottom: -3rem;
      }
    }
  }
}

.company-name {
  font-weight: lighter;
}
